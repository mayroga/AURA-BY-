<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AURA by May Roga LLC</title>
    <style>
        body { font-family: 'Segoe UI', Arial; background: #000; color: #fff; margin: 0; text-align: center; }
        .marquee { background: #001a33; border-bottom: 2px solid #00d4ff; overflow: hidden; white-space: nowrap; padding: 15px 0; }
        .marquee-content { display: inline-block; animation: scroll 35s linear infinite; color: #00d4ff; font-weight: 900; font-size: 1.2rem; }
        @keyframes scroll { from { transform: translateX(100%); } to { transform: translateX(-100%); } }
        .container { max-width: 950px; margin: auto; padding: 25px; border: 3px solid #00d4ff; border-radius: 40px; background: #080808; margin-top: 10px; }
        .yellow { color: #ffff00; font-weight: bold; font-size: 1.5rem; }
        .search-hero { font-size: 1.3rem; color: #00d4ff; font-weight: bold; margin: 20px 0; border: 1px dashed #00d4ff; padding: 20px; border-radius: 20px; line-height: 1.5; }
        .plan-card { border: 2px solid #00d4ff; border-radius: 20px; padding: 15px; margin: 10px; display: inline-block; width: 28%; vertical-align: top; background: #0a0a0a; }
        .btn-pay { background: #00d4ff; color: #000; border: none; padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; width: 100%; font-size: 1.1rem; transition: 0.3s; }
        .btn-pay:hover { background: #ffff00; }
        .input-group { position: relative; width: 85%; margin: 20px auto; }
        input { padding: 18px; border-radius: 15px; border: 2px solid #00d4ff; background: #000; color: #fff; font-size: 1.2rem; width: 100%; box-sizing: border-box; }
        .clear-btn { position: absolute; right: -60px; top: 50%; transform: translateY(-50%); background: #ff4d4d; color: white; border: none; border-radius: 10px; padding: 10px; cursor: pointer; font-weight: bold; }
        .res-box { text-align: left; padding: 25px; border: 1px dashed #00d4ff; background: #050505; margin-top: 25px; font-size: 1.1rem; line-height: 1.6; display: none; border-radius: 20px; white-space: pre-wrap; }
        .donacion-box { border: 5px solid #ffff00; border-radius: 35px; padding: 30px; margin-top: 40px; }
        .btn-donar { background: #ffff00; color: #000; border: none; padding: 20px; border-radius: 15px; font-weight: 900; width: 100%; cursor: pointer; font-size: 1.6rem; }
        .btn-ex { padding: 12px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; margin: 5px; color: white; }
        .login-box { margin: 20px auto; padding: 20px; border: 2px solid #00d4ff; border-radius: 25px; max-width: 400px; background: #0a0a0a; }
        .login-box input { width: 90%; margin: 10px auto; display: block; border-width: 1px; }
        .map-btn { display: block; background: #ff4d4d; color: white; padding: 15px; border-radius: 15px; text-decoration: none; font-weight: bold; margin-top: 15px; }
        .doubt-section { margin-top: 20px; border: 2px solid #ffff00; padding: 20px; border-radius: 25px; display: none; background: #111; }
    </style>
</head>
<body>

<div class="marquee">
    <div class="marquee-content" id="marquee-text">
        AURA BY MAY ROGA LLC: ESTIMADOS DE PRECIOS M√âDICOS ‚Ä¢ TRANSPARENCIA TOTAL ‚Ä¢ NO SOMOS M√âDICOS NI ASEGURADORAS ‚Ä¢ SOLO INFORMACI√ìN DE MERCADO ‚Ä¢
    </div>
</div>

<div class="container">
    <h1 style="color: #00d4ff; font-size: 4.5rem; margin: 0;">AURA</h1>
    <div class="yellow">by May Roga LLC</div>

    <div class="search-hero" id="search-hero">
        CONSULTA ESTIMADOS DE PRECIOS M√âDICOS Y DENTALES EN USA.<br>
        Introduce procedimiento o c√≥digo. Obt√©n ahorro por ZIP, Condado y Estado.
    </div>

    <div class="lang-box">
        <button class="btn-ex" style="background:#00d4ff; color:#000;" onclick="changeLang('es')">ESPA√ëOL</button>
        <button class="btn-ex" style="background:#fff; color:#000;" onclick="changeLang('en')">ENGLISH</button>
        <button class="btn-ex" style="background:#ff4d4d; color:#000;" onclick="changeLang('ht')">CREOL</button>
    </div>

    <div class="login-box" id="admin-section">
        <input type="text" id="admin-user" placeholder="Usuario Admin">
        <input type="password" id="admin-pass" placeholder="Contrase√±a">
        <button class="btn-pay" onclick="loginAdmin()">ACCESO ADMIN GRATIS</button>
    </div>

    <div id="paywall">
        <div class="plan-card"><h4>C. R√ÅPIDA</h4><p>$5.99</p><button class="btn-pay" onclick="pagar('rapido')">PAGAR</button></div>
        <div class="plan-card"><h4>STANDARD</h4><p>$9.99</p><button class="btn-pay" onclick="pagar('standard')">PAGAR</button></div>
        <div class="plan-card"><h4>ESPECIAL</h4><p>$19.99</p><button class="btn-pay" onclick="pagar('special')">PAGAR</button></div>
    </div>

    <div id="sistema-aura" style="display:none;">
        <div id="geo-txt">Detectando ubicaci√≥n...</div>
        
        <button onclick="startDictation()" style="font-size:4rem; background:none; border:none; cursor:pointer;">üé§</button>
        
        <div class="input-group">
            <input type="text" id="q" placeholder="¬øQu√© procedimiento busca?">
            <button class="clear-btn" onclick="document.getElementById('q').value=''">BORRAR</button>
        </div>

        <button class="btn-pay" onclick="getEstimate()" style="font-size:1.8rem; width:85%;">REVELAR COMPARATIVA AURA</button>
        
        <div id="res" class="res-box"></div>
        
        <a id="map-link" class="map-btn" href="#" target="_blank" style="display:none;">üìç VER CL√çNICAS M√ÅS BARATAS EN MAPA</a>

        <div id="export-bar" style="display:none; margin-top:20px;">
            <button class="btn-ex" style="background:#25d366;" onclick="shareWA()">WhatsApp</button>
            <button class="btn-ex" style="background:#ffff00; color:#000;" onclick="readOut()">Escuchar üîä</button>
            <button class="btn-ex" style="background:#ff9500; color:#000;" onclick="exportPDF()">PDF / Print</button>
        </div>

        <div id="doubt-section" class="doubt-section">
            <h3 style="color:#ffff00;">¬øTIENE DUDAS SOBRE ESTE REPORTE?</h3>
            <input type="text" id="doubt-q" placeholder="Pregunte a Aura detalles adicionales...">
            <button class="btn-pay" onclick="askAura()" style="margin-top:10px;">ACLARAR DUDA</button>
            <div id="doubt-res" style="margin-top:15px; color:#00d4ff;"></div>
        </div>
    </div>

    <div class="donacion-box">
        <h2 style="color:#ffff00; margin-top:0;">FONDO DE SOLIDARIDAD</h2>
        <button class="btn-donar" onclick="pagar('donacion')">DONACI√ìN VOLUNTARIA</button>
    </div>

    <div class="search-hero" style="font-size:0.8rem; border-style:solid; margin-top:30px; text-align: justify;">
        BLINDAJE LEGAL: Este reporte es emitido por Aura by May Roga LLC, agencia de informaci√≥n independiente. No somos m√©dicos, cl√≠nicas ni aseguradoras. Este es un ESTIMADO EDUCATIVO basado en datos de mercado.
    </div>
</div>

<script>
    let currentLang = 'es';
    let userZip = "";

    async function getGeo() {
        if(navigator.geolocation){
            navigator.geolocation.getCurrentPosition(async pos=>{
                const r = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${pos.coords.latitude}&longitude=${pos.coords.longitude}&localityLanguage=${currentLang}`);
                const data = await r.json();
                userZip = data.postcode || "";
                document.getElementById('geo-txt').innerText = `Ubicaci√≥n detectada: ZIP ${userZip}`;
            });
        }
    }
    window.onload = getGeo;

    function changeLang(l) {
        currentLang = l;
        const texts = {
            es: { hero: "CONSULTA ESTIMADOS DE PRECIOS M√âDICOS EN USA...", q: "¬øQu√© procedimiento busca?" },
            en: { hero: "CHECK MEDICAL PRICE ESTIMATES IN USA...", q: "What procedure are you looking for?" },
            ht: { hero: "TCHEKE ESTIMASYON PRI MEDIKAL NAN USA...", q: "Ki pwosedi w ap ch√®che?" }
        };
        document.getElementById('search-hero').innerText = texts[l].hero;
        document.getElementById('q').placeholder = texts[l].q;
    }

    async function loginAdmin() {
        const fd = new FormData();
        fd.append("user", document.getElementById('admin-user').value);
        fd.append("pw", document.getElementById('admin-pass').value);
        const r = await fetch("/login-admin", {method:"POST", body:fd});
        if(r.ok) {
            document.getElementById('paywall').style.display='none';
            document.getElementById('admin-section').style.display='none';
            document.getElementById('sistema-aura').style.display='block';
        } else { alert("Error de acceso."); }
    }

    async function getEstimate() {
        const q = document.getElementById('q').value;
        const resDiv = document.getElementById('res');
        resDiv.style.display='block';
        resDiv.innerHTML = "Aura analizando base de datos 3-3-5-1...";

        const fd = new FormData();
        fd.append("consulta", q);
        fd.append("lang", currentLang);
        fd.append("zip_user", userZip);

        const r = await fetch("/estimado", {method:"POST", body:fd});
        const d = await r.json();
        resDiv.innerHTML = d.resultado;
        
        document.getElementById('map-link').href = `https://www.google.com/maps/search/${encodeURIComponent(q)}+affordable+medical+near+${userZip}`;
        document.getElementById('map-link').style.display = 'block';
        document.getElementById('export-bar').style.display = 'block';
        document.getElementById('doubt-section').style.display = 'block';
    }

    function startDictation() {
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = currentLang === 'es' ? 'es-US' : 'en-US';
        recognition.onresult = (e) => { document.getElementById('q').value = e.results[0][0].transcript; };
        recognition.start();
    }

    function readOut() {
        const msg = new SpeechSynthesisUtterance(document.getElementById('res').innerText);
        msg.lang = currentLang === 'es' ? 'es-US' : 'en-US';
        window.speechSynthesis.speak(msg);
    }

    async function askAura() {
        const q = document.getElementById('doubt-q').value;
        const ctx = document.getElementById('res').innerText;
        const fd = new FormData();
        fd.append("pregunta", q);
        fd.append("contexto", ctx);
        const r = await fetch("/aclarar-duda", {method:"POST", body:fd});
        const d = await r.json();
        document.getElementById('doubt-res').innerHTML = "<strong>Aura responde:</strong> " + d.resultado;
    }

    function exportPDF() { window.print(); }
    function shareWA() { window.open(`https://wa.me/?text=${encodeURIComponent(document.getElementById('res').innerText)}`); }
    function pagar(p) { if(p==='donacion') window.location.href="https://buy.stripe.com/28E00igMD8dR00v5vl7Vm0h"; }
</script>
</body>
</html>
