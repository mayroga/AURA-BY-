<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AURA by May Roga LLC</title>
<style>
  body { font-family: 'Segoe UI', Arial; background: #000; color: #fff; margin: 0; text-align: center; }
  .marquee { background: #001a33; border-bottom: 2px solid #00d4ff; overflow: hidden; white-space: nowrap; padding: 15px 0; }
  .marquee-content { display: inline-block; animation: scroll 35s linear infinite; color: #00d4ff; font-weight: 900; font-size: 1.2rem; }
  @keyframes scroll { from { transform: translateX(0); } to { transform: translateX(-50%); } }
  .container { max-width: 950px; margin: auto; padding: 25px; border: 3px solid #00d4ff; border-radius: 40px; background: #080808; margin-top: 10px; }
  .yellow { color: #ffff00; font-weight: bold; font-size: 1.5rem; }
  .search-hero { font-size: 1.3rem; color: #00d4ff; font-weight: bold; margin: 20px 0; border: 1px dashed #00d4ff; padding: 20px; border-radius: 20px; line-height: 1.5; }
  .plan-card { border: 2px solid #00d4ff; border-radius: 20px; padding: 15px; margin: 10px; display: inline-block; width: 28%; vertical-align: top; background: #0a0a0a; }
  .btn-pay { background: #00d4ff; color: #000; border: none; padding: 15px; border-radius: 12px; font-weight: bold; cursor: pointer; width: 100%; font-size: 1.1rem; transition: 0.3s; }
  input { padding: 18px; border-radius: 15px; border: 2px solid #00d4ff; background: #000; color: #fff; margin: 10px; font-size: 1.2rem; width: 100%; box-sizing: border-box; }
  .res-box { text-align: left; padding: 25px; border: 1px dashed #00d4ff; background: #050505; margin-top: 25px; font-size: 1.1rem; line-height: 1.6; display: none; border-radius: 20px; overflow-x: auto; }
  .res-box table { width: 100%; border-collapse: collapse; color: #fff; }
  .res-box th, .res-box td { border: 1px solid #333; padding: 10px; text-align: left; }
  .res-box th { background: #001a33; color: #00d4ff; }
  .donacion-box { border: 5px solid #ffff00; border-radius: 35px; padding: 30px; margin-top: 40px; }
  .btn-donar { background: #ffff00; color: #000; border: none; padding: 20px; border-radius: 15px; font-weight: 900; width: 100%; cursor: pointer; font-size: 1.6rem; }
  .btn-ex { padding: 12px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; margin: 5px; color: white; }
  .login-box { margin: 20px auto; padding: 20px; border: 2px solid #00d4ff; border-radius: 25px; max-width: 400px; background: #0a0a0a; }
  #map { width: 100%; height: 300px; margin-top: 25px; border-radius: 20px; }
</style>
</head>
<body>

<div class="marquee">
  <div class="marquee-content">AURA BY MAY ROGA LLC: ESTIMADOS DE PRECIOS MÉDICOS PARA CONSUMIDORES • TRANSPARENCIA TOTAL • SOLO INFORMACIÓN DE MERCADO •</div>
</div>

<div class="container">
  <h1 style="color: #00d4ff; font-size: 4rem; margin: 0;">AURA</h1>
  <div class="yellow">by May Roga LLC</div>

  <!-- Selección idioma -->
  <div style="margin:15px;">
    <button class="btn-ex" onclick="changeLang('es')">ES</button>
    <button class="btn-ex" onclick="changeLang('en')">EN</button>
  </div>

  <!-- Login Admin -->
  <div class="login-box">
    <input type="text" id="admin-user" placeholder="Usuario">
    <input type="password" id="admin-pass" placeholder="Contraseña">
    <button class="btn-pay" onclick="loginAdmin()">ACCEDER</button>
  </div>

  <!-- Planes Stripe -->
  <div id="paywall">
    <div class="plan-card"><h4>C. RÁPIDA</h4><p>$5.99</p><button class="btn-pay" onclick="pagar('rapido')">PAGAR</button></div>
    <div class="plan-card"><h4>STANDARD</h4><p>$9.99</p><button class="btn-pay" onclick="pagar('standard')">PAGAR</button></div>
    <div class="plan-card"><h4>ESPECIAL</h4><p>$19.99</p><button class="btn-pay" onclick="pagar('special')">PAGAR</button></div>
  </div>

  <!-- Sistema AURA -->
  <div id="sistema-aura" style="display:none;">
    <div id="geo-txt" class="yellow">Detectando ubicación...</div>
    <input type="text" id="q" placeholder="Ej: MRI, D2750, Limpieza Dental">
    <button class="btn-pay" onclick="getEstimate()" style="font-size:1.8rem;">REVELAR COMPARATIVA AURA</button>
    <div id="res" class="res-box"></div>

    <!-- Reportar precio -->
    <div style="margin-top:15px;">
        <input type="text" id="report-code" placeholder="Código procedimiento">
        <input type="text" id="report-zip" placeholder="ZIP">
        <input type="text" id="report-state" placeholder="Estado">
        <input type="number" id="report-price" placeholder="Precio reportado">
        <button class="btn-ex" onclick="reportPrice()">Reportar Precio</button>
    </div>

    <!-- Export / Print / WhatsApp -->
    <div id="export-bar" style="display:none; margin-top:20px;">
        <button class="btn-ex" style="background:#25d366;" onclick="shareWhatsApp()">WhatsApp</button>
        <button class="btn-ex" style="background:#ffff00; color:#000;" onclick="window.print()">Print</button>
        <button class="btn-ex" onclick="readOut()">Escuchar</button>
    </div>

    <!-- Mapa ubicación -->
    <div id="map"></div>
  </div>

  <!-- Donación -->
  <div class="donacion-box">
    <h2 style="color:#ffff00;">FONDO DE SOLIDARIDAD</h2>
    <button class="btn-donar" onclick="pagar('donacion')">DONACIÓN VOLUNTARIA</button>
  </div>
</div>

<script>
// Idioma dinámico
let currentLang = 'es';
let userZip = "";

function changeLang(lang){
    currentLang = lang;
    document.getElementById('q').placeholder = (lang==='es') ? "Ej: MRI, D2750, Limpieza Dental" : "Ex: MRI, D2750, Dental Cleaning";
    document.getElementById('geo-txt').innerText = (lang==='es') ? "Detectando ubicación..." : "Detecting location...";
}

// Login Admin
async function loginAdmin() {
  const fd = new FormData();
  fd.append("user", document.getElementById('admin-user').value);
  fd.append("pw", document.getElementById('admin-pass').value);
  const r = await fetch("/login-admin", {method:"POST", body:fd});
  if(r.ok){
    document.getElementById('paywall').style.display='none';
    document.getElementById('sistema-aura').style.display='block';
    initMap();
  } else { alert("Error de acceso."); }
}

// Stripe Checkout
async function pagar(plan){
  const fd = new FormData();
  fd.append("plan", plan);
  const r = await fetch("/create-checkout-session", {method:"POST", body:fd});
  const data = await r.json();
  if(data.url) window.location.href = data.url;
}

// Obtener estimado
async function getEstimate() {
  const q = document.getElementById('q').value;
  const resDiv = document.getElementById('res');
  resDiv.style.display='block';
  resDiv.innerHTML = "<h2 class='yellow'>Procesando reporte 3-3-5-1...</h2>";
  
  const fd = new FormData();
  fd.append("consulta", q);
  fd.append("lang", currentLang);
  fd.append("zip_user", userZip);

  const r = await fetch("/estimado", {method:"POST", body:fd});
  const d = await r.json();
  resDiv.innerHTML = d.resultado;
  document.getElementById('export-bar').style.display='block';
}

// Reportar precio usuario
async function reportPrice(){
    const fd = new FormData();
    fd.append("code", document.getElementById('report-code').value);
    fd.append("zip_user", document.getElementById('report-zip').value);
    fd.append("state", document.getElementById('report-state').value);
    fd.append("precio", document.getElementById('report-price').value);
    const r = await fetch("/reportar-precio", {method:"POST", body:fd});
    const d = await r.json();
    alert(d.msg);
}

// Leer en voz alta
function readOut(){ 
    const ut = new SpeechSynthesisUtterance(document.getElementById('res').innerText); 
    window.speechSynthesis.speak(ut); 
}

// WhatsApp compartir
function shareWhatsApp(){
    const texto = encodeURIComponent(document.getElementById('res').innerText);
    const url = `https://wa.me/?text=${texto}`;
    window.open(url,'_blank');
}

// Mapa simple (solo display)
function initMap(){
    const mapDiv = document.getElementById('map');
    mapDiv.innerHTML = `<iframe width="100%" height="300" frameborder="0" style="border:0" src="https://www.google.com/maps/embed/v1/place?key=YOUR_GOOGLE_MAPS_API_KEY&q=Miami,FL" allowfullscreen></iframe>`;
}
</script>

</body>
</html>
